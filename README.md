# Frenet transformation

This project implements a library to perform transformations from a 2-dimensional Cartesian to a Frenet coordinate system and vice versa.
Transformations are implemented for states up to the second time derivative.
The reference path defining the Frenet coordinate system is represented by a polychain.

## Installation

Since this is a header-only library it is sufficient to include the required header files from the directory *include/frenetTransform*.

### Integration in CMake project

If you desire an integration in a CMake project you may utilize the *FetchContent* module.

```bash
FetchContent_Declare(
  transform
  GIT_REPOSITORY https://github.com/CoteGoal/frenet-state-transformation
)
set(BUILD_TEST OFF)
set(BUILD_BENCHMARK OFF)
set(BUILD_DOCS OFF)
set(BUILD_EXAMPLES OFF)
set(BUILD_PYBINDS OFF)
FetchContent_MakeAvailable(transform)

...

target_link_libraries(<your-target> PRIVATE transform)
```

### Build from source

Building the project with the benchmark and tests requires enabling the respective CMake configuration flags.

```bash
cmake -Bbuild
cmake --build build
```

The following options are avaible for configuration:

- BUILD_DOCS=ON|OFF: whether to build the documentation
- BUILD_TEST=ON|OFF: whether to build the tests
- BUILD_BENCHMARK=ON|OFF: whether to build the benchmarks
- BUILD_EXAMPLES=ON|OFF: whether to build the examples
- BUILD_PYBINDS=ON|OFF: whether to build the python bindings

### Python bindings

The python bindings are installed locally by invoking

```bash
pip install .
```

The stubs that document the python bindings are generated by installting the package twice:

```bash
source setup.bash
pip install .[STUBS]
python $PATH_PYBINDS/frenetTransform/build_stubs.py
pip install .
```

For the execution of the examples additional dependencies are installed by invoking

```bash
pip install .[EXAMPLES]
```

### Install from PyPI

The Python package *frenetTransform* is also available on [PyPI](https://pypi.org/project/frenet-state-transformation/) and installed with

```bash
pip install frenet-state-transformation
```

## Examples

The examples demonstrate the usage of the library.
Equivalent examples are provided in C++ and Python.
For running the C++ examples setup the environment variables and invoke the launch script from the repository root:

```bash
source setup.bash
examples/cpp/launch.bash [options] <source-file-name>
```

Note that the examples require [gnuplot](http://gnuplot.info/) to plot the results.
The Python examples are executed directly:

```bash
python examples/python/<source-file-name>.py
```

### Circle polychain

The examples [circlePolychain.cpp](examples/cpp/circlePolychain.cpp) and [circlePolychain.py](examples/python/circlePolychain.py) illustrate the transformation of a velocity and acceleration vectorfield from the Cartesian to the Frenet coordinate system and vice versa along a circle.

![Frenet transform of position, velocity, and acceleration](docs/media/circlePolychain.png)

The transformation of query points projected to a polychain vertex is not uniquely defined resulting in a deviation between the initial and final cartesian vectorfields.

### Coarse polychain

The examples [coarsePolychain.cpp](examples/cpp/coarsePolychain.cpp) and [coarsePolychain.py](examples/python/coarsePolychain.py) illustrate the transformation of query points to a coarse square-shaped polychain.

![Projection of query points to a coarse polychain](docs/media/coarsePolychain.png)

The top corner illustrates the discontinuity at vertices, where the distance along the path is not uniquely defined.

## Benchmarks

For running the benchmarks setup the environment variables and invoke the script *benchmarks/benchmarks.bash* from the repository root.

```bash
source setup.bash
benchmarks/launch.bash [options] <source-file-names>
```

Invoke `benchmarks/launch.bash -h` for additional information.
